## editor命名为 editormd
<script src="/editor.md-master/editormd.js"></script>
<script src="/dist/js/tempSave.js"></script>
<script src="/editor.md-master/lib/marked.min.js"></script>
<script src="/editor.md-master/lib/prettify.min.js"></script>
<script src="/editor.md-master/lib/raphael.min.js"></script>
<script src="/editor.md-master/lib/underscore.min.js"></script>
<script src="/editor.md-master/lib/sequence-diagram.min.js"></script>
<script src="/editor.md-master/lib/flowchart.min.js"></script>
<script src="/editor.md-master/lib/jquery.flowchart.min.js"></script>

<script type="text/javascript">
	#if($question.id)
		var thisQuestionID = "$question.id";
	#else
		var thisQuestionID = "newQuestion";
	#end

    var testEditor=null;
    var editorConfig=null;
    
    function setEditorConfig(config){
    	editorConfig = config;
    }

	$(function() {
		defaultEditorConfig = {
			width: "100%",
			height: 340,
			path: '/editor.md-master/lib/',
			watch: true,
			emoji: true,
			
			imageUpload: true,
			imageFormats: ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
			imageUploadURL: "./php/upload.php?test=dfdf",
			
			toolbarIcons: function() {
				return editormd.toolbarModes["simple"]
			},

			onload: editorOnLoad

		};
		
		if(editorConfig){
			$.extend(defaultEditorConfig, editorConfig);
		}
		
		testEditor = editormd("editormd", defaultEditorConfig);
		testEditor.questionID = thisQuestionID;
		testEditor.timelySave = editorOnChange;
		testEditor.isSubmitMarkDown = false;
		testEditor.clearStorage = function(){
			this.isSubmitMarkDown = true;
			console.log(this.questionID);
			localStorage[this.questionID] = "";
		};
		
		function savePolling() {
			if(!testEditor.isSubmitMarkDown){
				testEditor.timelySave();
				setTimeout(savePolling, 1000);
			}
		}

		setTimeout(savePolling, 1000);

		
	});
</script>